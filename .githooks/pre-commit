#!/bin/sh
# Pre-commit hook for gpq-tiles
# Runs cargo fmt check and syncs READMEs before allowing commit

echo "Running cargo fmt check..."
if ! cargo fmt --all -- --check 2>/dev/null; then
    echo ""
    echo "ERROR: Code is not formatted. Run 'cargo fmt --all' to fix."
    echo ""
    exit 1
fi
echo "Format check passed!"

# Sync READMEs to subcrates
echo "Syncing README.md to subcrates..."
cp README.md crates/core/README.md
cp README.md crates/cli/README.md
cp README.md crates/python/README.md
git add crates/core/README.md crates/cli/README.md crates/python/README.md 2>/dev/null || true
echo "READMEs synced!"
